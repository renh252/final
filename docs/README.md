# 專案文檔指南

此目錄包含用於提高專案開發效率和 AI 對話質量的文檔。通過提供這些文檔給 AI，可以大幅減少幻覺情況，讓 AI 更準確地了解專案結構和設計細節。

## 核心文檔

1. **[專案概述](./project-overview.md)** - 專案技術棧、檔案結構和主要功能模塊
2. **[資料庫結構](./database-structure.md)** - 詳細的資料庫表格結構和關係
3. **[後台管理系統結構](./admin-structure.md)** - 後台管理系統的路由結構和功能模塊
4. **[前端元件結構](./frontend-components.md)** - 前端元件的結構和使用方式
5. **[API 結構](./api-structure.md)** - API 路由結構和設計原則
6. **[當前狀態與計劃](./current-status.md)** - 項目當前狀態和下一步計劃

## 專案概述

Pet Project 是一個綜合性的寵物領養和社區平台，包含以下主要功能：

1. **寵物領養功能** - 瀏覽和搜尋可領養的寵物，提交領養申請，預約看寵物
2. **社群討論區** - 創建和回覆貼文，點讚和收藏貼文，上傳圖片
3. **寵物用品商城** - 商品分類和搜尋，購物車功能，結帳流程，訂單追蹤
4. **捐款和公益活動** - 捐款功能，公益活動展示，資金使用透明度報告
5. **會員管理系統** - 會員註冊和登入，會員資料管理，收藏和訂單管理
6. **管理後台** - 寵物資訊管理，會員管理，商城管理，論壇管理，金流管理

### 技術棧

- **前端**: Next.js 14 (App Router), TypeScript, React Bootstrap
- **後端**: Next.js API Routes, TypeScript, MySQL
- **認證**: JWT (JSON Web Token)
- **部署**: 計劃部署到 Vercel 或 AWS

## 如何在 AI 對話中使用這些文檔

### 方法一：在對話開始時提供文檔內容

在啟動新對話時，將相關文檔的內容複製到對話中，如：

```
我正在開發一個寵物平台專案，以下是我們專案的資料庫結構和架構設計：

[此處粘貼 database-structure.md 和/或 project-overview.md 的內容]

基於以上資訊，我想請教...
```

### 方法二：根據需要提供特定部分

如果只針對特定功能或模塊進行討論，可僅提供相關部分：

```
我正在處理專案的寵物領養模塊，以下是相關資料庫表格和API:

[僅粘貼 database-structure.md 中寵物相關表格的定義]
[僅粘貼 project-overview.md 中寵物領養模塊的描述]

我遇到的問題是...
```

### 方法三：請 AI 參考已上傳的文檔

如果您使用的 AI 平台支持上傳文件功能，可將文檔直接上傳：

```
我已上傳我們專案的資料庫結構和架構設計文檔。請參考這些文檔，幫我...
```

## 文檔更新指南

為確保文檔的有效性，請在以下情況下更新文檔：

1. 資料庫結構發生變化時
2. 添加新的功能模塊時
3. 技術棧或架構有重大調整時
4. 發現 AI 在某些專案細節上出現頻繁幻覺時

## 貢獻

歡迎團隊成員對文檔進行改進和擴充。如果發現文檔中有不準確或過時的內容，請提交更新。

## 文檔格式指南

- 使用 Markdown 格式編寫
- 資料庫結構使用 SQL 代碼塊
- 提供清晰的標題和小標題
- 使用表格組織相關信息
- 代碼示例使用適當的語法高亮

## 注意事項

- **敏感信息**: 請確保文檔中不包含任何敏感信息，如真實的資料庫密碼、API 密鑰等
- **最新性**: 定期檢查文檔以確保內容是最新的
- **完整性**: 嘗試包含 AI 可能需要了解的所有重要上下文

## 目錄結構

- `project-overview.md`: 專案概覽
- `database-structure.md`: 資料庫結構說明
- `db-structure-usage.md`: 資料庫使用指南
- `admin-structure.md`: 後台管理系統結構
- `frontend-components.md`: 前端元件結構
- `api-structure.md`: API 結構
- `current-status.md`: 當前狀態與計劃

## 認證機制說明

### Token 管理

- 使用 JWT (JSON Web Token) 進行認證
- Token 存儲在 Cookie 中（名稱：`admin_token`）
- Token 包含以下資訊：
  - `id`: 管理員 ID
  - `account`: 管理員帳號
  - `privileges`: 權限代碼
  - `role`: 角色（預設為 'admin'）

### 權限驗證流程

1. 登入時生成 JWT，包含完整的管理員資訊
2. API 請求時需在 Header 中攜帶 Token：
   ```typescript
   headers: {
     'Authorization': `Bearer ${token}`,
     'Content-Type': 'application/json'
   }
   ```
3. 後端驗證 Token 的有效性和權限

### 常見問題與解決方案

1. 401 未授權錯誤：

   - 檢查 Cookie 中是否存在 `admin_token`
   - 確認 Token 格式是否正確
   - 驗證 Token 是否過期

2. 403 權限不足：

   - 確認管理員權限設置
   - 檢查 Token 中的 role 和 privileges

3. Token 獲取失敗：
   - 使用 `js-cookie` 庫獲取 Token：
     ```typescript
     const token = Cookies.get('admin_token')
     ```
   - 不要使用 localStorage 存儲 Token

## 避免 AI 幻覺的最佳實踐

### 資料庫結構

1. 明確定義表結構和欄位名稱
2. 保持文檔與實際資料庫結構同步
3. 記錄特殊的欄位命名規則

### API 請求

1. 明確記錄 API 的請求和響應格式
2. 標註必要的請求頭和認證要求
3. 提供完整的錯誤處理範例

### 前端組件

1. 明確定義 Props 和 State 的類型
2. 記錄組件間的資料流動
3. 提供完整的錯誤處理機制

### 認證流程

1. 清楚說明 Token 的生成和存儲方式
2. 記錄權限驗證的具體邏輯
3. 提供常見錯誤的處理方法

## 開發注意事項

1. 始終使用類型檢查（TypeScript）
2. 保持錯誤處理的一致性
3. 遵循統一的代碼風格
4. 及時更新文檔

## 測試指南

1. 提供完整的測試案例
2. 包含認證相關的測試
3. 記錄常見的測試場景

## 已知問題和限制

請參考 [當前狀態與計劃](./current-status.md) 文檔中的「已知問題」部分。

## 下一步計劃

請參考 [當前狀態與計劃](./current-status.md) 文檔中的「下一步計劃」部分。
